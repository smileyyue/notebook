#Qt学习笔记
[TOC]

## 概述
- 人生苦短，我用python。所以我用的是pyqt5，而且我觉得我的选择很正确，python能让我更专注于qt的问题，而不受指针等乱七八糟的东西干扰。
- 没找到pyqt5专门的官方文档，但是看C++ Class的官方文档也一样，挺方便的，内部还能搜索。另外直接百度实现也是不错的方式；

## 被坑的地方
- qt设置的最后一个可视窗口关闭后自动退出程序，需要通过`app.setQuitOnLastWindowClosed(False)`设置禁止自动退出；
- ***不要把一个窗口类作为主程序去运行，每个窗口类的主要作用应该就是初始化、提供各种展示界面，调整，信号发送，处理的接口，不要在内部跑流程，比如跑定时器、死循环、流程什么的，流程都在主程序里做；***
- 主程序可以是一个主窗口或者一个不可见窗口，如果是不可见窗口需要设置第一条的哪个命令；
- 尽量不要嵌套窗口，尤其是在子窗口操作父窗口，会很麻烦；
- qt的执行和其他界面程序比如MFC都类似，虽然各个窗口看似是并行的，互不干扰的，但实际上是同一个线程中串行执行的，只不过是窗口完成后就放在那里不管了而已，任何一个窗口都不要sleep或者死循环，想做这些的话单独开个线程，想要挂起等事件的话，使用信号与槽的机制；
- 重写`closeEvent()`事件后，如果写了无条件`event.ignore()`，则无论使用`close()`还是任何方式，都不能退出了，除非出错或者杀死进程，所以尽量不要设置为无条件，最好有条件；
- 不要再事件里无条件跳转到另一个函数或窗口，然后另一个窗口或函数中又触发该事件，这样会形成死循环出不去，不执行后续程序；
- 除转专门的enum等数据结构类外，不要外部直接操作类内成员变量，直接操作不会修改类内成员变量，而是会生成一个新的变量并赋值，想修改类内成员变量必须使用成员函数修改；
- python可以多个类放到一个模块里面；
- 一个窗口一个布局是最好的，设置好后再乱改布局很不好改，容易出问题。

## 另外
- 打包程序可以使用pyinstaller，具体用法是：`pyinstaller.exe -F 目标程序文件路径 --noconsole`
    - 没有noconsole的话最终程序运行后会出现一个控制台的黑框
    - 这条命令会生成一个单独的.exe文件
    - pyinstaller直接使用pip3安装即可
    - pyinstaller实际上是把程序和python解释器一起给打包了，并不是编译python程序，优点是容易发布，缺点是效率并没有提高，反而有所降低。